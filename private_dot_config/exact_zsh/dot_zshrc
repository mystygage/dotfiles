# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

#
# Executes commands at the start of an interactive session.
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...

# Optimize the history
setopt HIST_FIND_NO_DUPS
setopt HIST_IGNORE_SPACE

# ignore accidental yubikey input
HISTORY_IGNORE="cccccc*"

# ensure a big history
HISTSIZE=200000
SAVEHIST=100000

# fzf search for ctrl-r
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# Jump, `cd` on steroids
# Usage: `j dotfiles` instead of `cd ~/Projects/private/dotfiles`
eval "$(jump shell)"

# 1Password CLI
eval "$(op completion zsh)"; compdef _op op

# use yubikey agent
export SSH_AUTH_SOCK="$(brew --prefix)/var/run/yubikey-agent.sock"

## exa instead of ls (https://the.exa.website/)
alias l='exa'
alias la='exa -a'
alias ll='exa -lah'
alias ls='exa --color=auto'

## Git Alias
alias gcleanremote="git branch -vv | grep ': gone]' | grep -v '\*' | awk '{ print $1; }' | xargs -r git branch -d"
alias gcleanlocal='git branch --merged main | grep -v "^\* main" | xargs -n 1 -r git branch -d'

## Kubernetes
alias k='kubectl'
compdef __start_kubectl k

alias kn='kubectl config set-context --current --namespace'

# To customize prompt, run `p10k configure` or edit "${ZDOTDIR:-$HOME}/.p10k.zsh".
[[ ! -f "${ZDOTDIR:-$HOME}/.p10k.zsh" ]] || source "${ZDOTDIR:-$HOME}/.p10k.zsh"
